<?xml version="1.0"?>
<project name="protobuf_genereate_source" basedir="./">
	<target name="prepare">
		<mkdir dir="target/generated-sources" />
		<path id="proto.path">
			<fileset dir="resources/protostuff/">
				<include name="**/*.proto" />
			</fileset>
		</path>
		<path id="proto_db.path">
			<fileset dir="resources/db/">
				<include name="**/*.proto" />
			</fileset>
		</path>
		<condition property="exe_name" value="bin/protoc361win.exe">
			<os family="windows" />
		</condition>
		<condition property="exe_name" value="bin/protoc361mac">
			<os family="mac" />
		</condition>
		<condition property="exe_name" value="bin/protoc361linux">
			<os family="unix" />
		</condition>
		<pathconvert pathsep=" " property="proto.files" refid="proto.path" />
		<pathconvert pathsep=" " property="proto_db.files" refid="proto_db.path" />
	</target>
	<target name="run_protoc" depends="prepare">
		<echo message="run ${exe_name}" />
		<exec executable="${exe_name}">
			<arg value="--java_out=target/generated-sources" />
			<arg value="--proto_path=${basedir}/resources/protostuff/" />
			<arg value="--proto_path=${basedir}/resources/db/" />
			<arg line="${proto.files} ${proto_db.files}" />
		</exec>
	</target>
	<target name="main" depends="run_protoc">
	</target>
</project>